#  pes_linearfsr

## Introduction 
LFSRs (linear feedback shift registers) provide a simple means for generating nonsequential lists of numbers quickly on microcontrollers. Generating the pseudo-random numbers only requires a right-shift operation and an XOR operation.A LFSR is specified entirely by its polynomial.    

## Applications of LFSR 
* Uses as counters
* Uses in cryptography
* Uses in circuit testing
* Uses in digital broadcasting and communications
*  radio jamming systems
  
## Block diagram of LFSR
![image](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/a89c111e-0bfd-4634-9bb1-9fc4739dc5e0)

## Required tools
* iverilog -> Icarus Verilog is an open source Verilog compiler that supports the IEEE-1364 Verilog HDL including IEEE1364-2005 plus extensions.
> sudo apt-get install iverilog
* Yosys -> Yosys is a framework for Verilog RTL synthesis. It currently has extensive Verilog-2005 support and provides a basic set of synthesis algorithms for various application domains.
* Gtkwave -> GTKWave is a fully featured GTK+ based wave viewer for Unix and Win32 which reads LXT, LXT2, VZT, FST, and GHW files as well as standard Verilog VCD/EVCD files and allows their viewing.
> sudo apt-get install gtkwave 

## Executing the project

> git clone

> cd pes_linearfsr

> iverilog pes_linearfsr.v pes_linearfsr_tb.v -o pes_linearfsr

> ./pes_linearfsr

> gtkwave pes_linearfsr.vcd

![image](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/563738cd-0e93-421b-b59c-4fca7006f75f)

## Gate level synthesis(GLS)
 While performing GLS we use skywater 130 nm technology library files to import the cells from the library. Using those cells we then generate the netlist which would be a new .v file generated by 
 write_verilog command. With this file and the testbench we generated for the RTL simulation we would again get a new waveform for this GLS netlist. This waveform should match with our initial waveform, 
 infact waveforms if every stages of the flow should match the initial design waveform.

* Go to the directory where verilog file is present and open terminal
* invoke Yosys

  > yosys> read_liberty -lib ../lib/sky130_fd_sc_hd__tt_025C_1v80.lib
  
  > yosys> read_verilog pes_linearfsr.v
  
  > yosys> synth -top pes_linearfsr
  
  > abc -liberty ../lib/sky130_fd_sc_hd__tt_025C_1v80.lib
  
  > yosys>flatten
  
  > yosys> show
  
  > yosys> write_verilog -noattr pes_linearfsr_net.v

![WhatsApp Image 2023-10-16 at 18 49 41_179ec20a](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/b056b16b-b5db-4629-8baa-487dd812e2a6)

![WhatsApp Image 2023-10-16 at 18 49 41_56b0915e](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/e96e1da0-608c-4481-8ae5-38c8aff2cb5c)

![WhatsApp Image 2023-10-16 at 18 49 41_4a2b3df0](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/a700b503-6042-4fcf-ad7a-726dee067dcd)

![WhatsApp Image 2023-10-16 at 18 49 41_9cfd07d5](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/3c16fbbd-c83d-4e8d-8c2e-daae660c0115)

![WhatsApp Image 2023-10-16 at 18 49 41_a43966c4](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/2933d04b-473c-4d6d-b0f5-ac31bb8c5791)

![WhatsApp Image 2023-10-16 at 18 49 41_00717bcf](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/c8355774-e82d-4237-b2f6-9504b08c992a)


## Synthesized circuit
![WhatsApp Image 2023-10-16 at 18 49 47_5b6ba7e7](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/8237153b-2a53-4ca3-98e4-06433644d866)

* Invoke GLS
  
>  iverilog ../verilog_model/primitives.v ../verilog_model/sky130_fd_sc_hd.v pes_linearfsr_net.v pes_linearfsr_tb.v

> ./a.out

>  gtkwave pes_linearfsr_tb.vcd

![WhatsApp Image 2023-10-16 at 18 49 41_28b8f2dd](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/f168b017-54e1-4383-9cd7-4894f1866c43)


* Gate level simulation
  ![image](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/db13907e-9e5b-4496-ba6c-2ae025fc3f7e)

# Physical design
## Installation of ngspice, magic and OpenLane
### ngspice
Download the tarball from https://sourceforge.net/projects/ngspice/files/ to a local directory

 > cd $HOME

 >  sudo apt-get install
 
 > libxaw7-dev tar -zxvf ngspice-41.tar.gz cd ngspice-41
 
 > mkdir release
 
 >  cd release
 
 >  ../configure  --with-x --with-readline=yes --disable-debug
 
 >  sudo make
 
 >  sudo make install

### magic
Magic is a venerable VLSI layout tool, written in the 1980's at Berkeley by John Ousterhout, now famous primarily for writing the scripting interpreter language Tcl. Due largely in part to its liberal Berkeley 
open-source license, magic has remained popular with universities and small companies. The open-source license has allowed VLSI engineers with a bent toward programming to implement clever ideas and help magic 
stay abreast of fabrication technology. However, it is the well thought-out core algorithms which lend to magic the greatest part of its popularity. Magic is widely cited as being the easiest tool to use for 
circuit layout, even for people who ultimately rely on commercial tools for their product design flow.
Run following commands one by one to fulfill the system requirement.

>   sudo apt-get install m4

>   sudo apt-get install tcsh

>   sudo apt-get install csh

>   sudo apt-get install libx11-dev

>   sudo apt-get install tcl-dev tk-dev

>   sudo apt-get install libcairo2-dev

>   sudo apt-get install mesa-common-dev libglu1-mesa-dev

>   sudo apt-get install libncurses-dev

Go to home directory and type the following commands

> git clone https://github.com/RTimothyEdwards/magic

> cd magic

> ./configure

> sudo make

> sudo make install

### OpenLane

> sudo apt-get update

> sudo apt-get upgrade

> sudo apt install -y build-essential python3 python3-venv python3-pip make git

> sudo apt install apt-transport-https ca-certificates curl software-properties-common

> curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg

> echo "deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

> sudo apt update

> sudo apt install docker-ce docker-ce-cli containerd.io

> sudo docker run hello-world

> sudo groupadd docker

> sudo usermod -aG docker $USER

> sudo reboot 

### After reboot run 

> docker run hello-world 

The above command should display a message  under 'Example Output' in https://hub.docker.com/_/hello-world)
- To install the PDKs and Tools

> cd $HOME

> git clone https://github.com/The-OpenROAD-Project/OpenLane

> cd OpenLane

> make

> make test

### Generating Layout

>  cd OpenLane/

>   cd designs/

>   mkdir pes_linearfsr

>   cd pes_linearfsr

>   mkdir src

>   cd src

* The following files should be present in the directory.

* Now in the main 'Openlane' directory type mkdir pdks. ANd add the design .v file


* Type make mount in the main Openlane terminal
  
  > make mount
  
  > ./flow.tcl -inreractive
  
  > prep -design pes_linearfsr

  ![WhatsApp Image 2023-11-02 at 20 03 49_684527b8](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/7ce1e5d0-cc07-4e0c-a68e-c91cbc00eeb9)

  > run_synthesis

  61. Printing statistics.

=== pes_linearfsr ===

   Number of wires:                 21
  
   Number of wire bits:             24
  
   Number of public wires:          13
  
   Number of public wire bits:      16
  
   Number of memories:               0
  
   Number of memory bits:            0
  
   Number of processes:              0
  
   Number of cells:                 17
    
  sky130_fd_sc_hd__buf_1          4
    
  sky130_fd_sc_hd__dfrtp_2        4
  
  sky130_fd_sc_hd__inv_2          4
     
  sky130_fd_sc_hd__mux2_2         4
   
  sky130_fd_sc_hd__xor2_2         1

   Chip area for module '\pes_linearfsr': 196.438400

* flop ratio= 4/17 =0.2352
  
  ![WhatsApp Image 2023-11-02 at 20 03 47_fd192fa8](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/6a16c944-d4ad-4d58-a790-e83d188f1531)
  
  > magic -T /home/pavithra/Desktop/sky130A.tech lef read ../../tmp/merged.nom.lef def read pes_linearfsr.def &

 ![image](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/5fbe27f3-2999-4a12-90d9-81a4dec096d8)

 
  > run_floorplan

  > run_placement
  
  > run_cts
  
  ![WhatsApp Image 2023-11-02 at 20 03 46_05cb9cc9](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/6fd6f291-5d38-4654-ac72-de4391c4cfcd)

    ===========================================================================
    report_checks -unconstrained
    ===========================================================================
    ======================= Typical Corner ===================================

    Startpoint: rst (input port clocked by clk)
    Endpoint: _23_ (recovery check against rising-edge clock clk)
    Path Group: asynchronous
    Path Type: max

    Fanout     Cap    Slew   Delay    Time   Description
    -----------------------------------------------------------------------------
                  0.15    0.00    0.00   clock clk (rise edge)
                          0.00    0.00   clock network delay (ideal)
                          2.00    2.00 v input external delay
     1    0.00    0.01    0.00    2.00 v rst (in)
                                         rst (net)
                  0.01    0.00    2.00 v input2/A (sky130_fd_sc_hd__clkbuf_4)
     4    0.04    0.09    0.18    2.18 v input2/X (sky130_fd_sc_hd__clkbuf_4)
                                         net2 (net)
                  0.09    0.01    2.19 v _19_/A (sky130_fd_sc_hd__inv_2)
     1    0.00    0.04    0.06    2.25 ^ _19_/Y (sky130_fd_sc_hd__inv_2)
                                         _02_ (net)
                  0.04    0.00    2.25 ^ _23_/RESET_B (sky130_fd_sc_hd__dfrtp_2)
                                  2.25   data arrival time

                  0.15   10.00   10.00   clock clk (rise edge)
                          0.00   10.00   clock network delay (ideal)
                         -0.25    9.75   clock uncertainty
                          0.00    9.75   clock reconvergence pessimism
                                  9.75 ^ _23_/CLK (sky130_fd_sc_hd__dfrtp_2)
                          0.25   10.00   library recovery time
                                 10.00   data required time
-----------------------------------------------------------------------------
                                 10.00   data required time
                                 -2.25   data arrival time
-----------------------------------------------------------------------------
                                  7.75   slack (MET)


    Startpoint: _23_ (rising edge-triggered flip-flop clocked by clk)
    Endpoint: q (output port clocked by clk)
    Path Group: clk
    Path Type: max

    Fanout     Cap    Slew   Delay    Time   Description
    -----------------------------------------------------------------------------
                  0.15    0.00    0.00   clock clk (rise edge)
                          0.00    0.00   clock network delay (ideal)
                  0.15    0.00    0.00 ^ _23_/CLK (sky130_fd_sc_hd__dfrtp_2)
     2    0.02    0.08    0.49    0.49 v _23_/Q (sky130_fd_sc_hd__dfrtp_2)
                                         F[2].q (net)
                  0.08    0.00    0.49 v _10_/A (sky130_fd_sc_hd__xor2_4)
     2    0.02    0.21    0.26    0.75 ^ _10_/X (sky130_fd_sc_hd__xor2_4)
                                         net7 (net)
                  0.21    0.00    0.75 ^ output7/A (sky130_fd_sc_hd__buf_2)
     1    0.03    0.17    0.26    1.02 ^ output7/X (sky130_fd_sc_hd__buf_2)
                                         q (net)
                  0.17    0.00    1.02 ^ q (out)
                                  1.02   data arrival time

                  0.15   10.00   10.00   clock clk (rise edge)
                          0.00   10.00   clock network delay (ideal)
                         -0.25    9.75   clock uncertainty
                          0.00    9.75   clock reconvergence pessimism
                         -2.00    7.75   output external delay
                                  7.75   data required time
-----------------------------------------------------------------------------
                                  7.75   data required time
                                 -1.02   data arrival time
-----------------------------------------------------------------------------
                                  6.73   slack (MET)




    ===========================================================================
    report_checks --slack_max -0.01
    ============================================================================
    ======================= Typical Corner ===================================

    No paths found.


    ===========================================================================
    report_check_types -max_slew -max_cap -max_fanout -violators
    ============================================================================
    ======================= Typical Corner ===================================


    max slew violations count Typical: 0
    max fanout violations count Typical: 0
    max cap violations count Typical: 0

    ===========================================================================
    report_parasitic_annotation -report_unannotated
    ============================================================================
    Found 34 unannotated drivers.
    clk
    load
    rst
    seed[0]
    seed[1]
    seed[2]
    seed[3]
    _08_/X
    _09_/X
    _10_/X
    _11_/X
    _12_/X
    _13_/X
    _14_/X
    _15_/X
    _16_/X
    _17_/Y
    _18_/Y
    _19_/Y
    _20_/Y
    _21_/Q
    _22_/Q
    _23_/Q
    _24_/Q
    clkbuf_0_clk/X
    clkbuf_1_0__f_clk/X
    clkbuf_1_1__f_clk/X
    input1/X
    input2/X
    input3/X
    input4/X
    input5/X
    input6/X
    output7/X
    Found 0 partially unannotated drivers.

    ===========================================================================
    max slew violation count 0
    max fanout violation count 0
    max cap violation count 0
    ============================================================================

    ===========================================================================
    check_setup -verbose -unconstrained_endpoints -multiple_clock -no_clock -no_input_delay -loops -generated_clocks
    ===========================================================================


> run_routing

 skew report 

![image](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/2ff1d85b-cdeb-4177-accd-fb6c1d759ee9)

power report

![image](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/21c140d7-792b-4c8e-ae9c-f94d081eca68)

    Summary Report and Area Report
    ===========================================================================
    report_tns
    ============================================================================
    tns 0.00

    ===========================================================================
    report_wns
    ============================================================================
     wns 0.00

    ===========================================================================
    report_worst_slack -max (Setup)
    ============================================================================
    worst slack 6.87

    ===========================================================================
    report_worst_slack -min (Hold)
    ============================================================================
    worst slack 0.38



### power
    ===========================================================================
    report_power
    ============================================================================
    ======================= Typical Corner ===================================

    Group                  Internal  Switching    Leakage      Total
                          Power      Power      Power      Power (Watts)
    ----------------------------------------------------------------
    Sequential             1.75e-05   1.29e-06   4.46e-11   1.88e-05  20.8%
    Combinational          5.49e-05   1.64e-05   1.25e-09   7.13e-05  79.2%
    Macro                  0.00e+00   0.00e+00   0.00e+00   0.00e+00   0.0%
    Pad                    0.00e+00   0.00e+00   0.00e+00   0.00e+00   0.0%
    ----------------------------------------------------------------
    Total                  7.24e-05   1.77e-05   1.30e-09   9.00e-05 100.0%
                          80.4%      19.6%       0.0%


                          

* note:- make sure there is > sky130.tech file
  is present in desktop
> magic -T /home/pavithra/Desktop/sky130A.tech lef read ../../tmp/merged.nom.lef def read pes_linearfsr.def &

![image](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/e0cb451b-0282-49de-8a68-018a35210bc6)

 
to run rtl to gds
  
> ./flow.tcl -design pes_linearfsr -init_design_config -add_to_designs

 ![WhatsApp Image 2023-11-02 at 20 19 41_477caae0](https://github.com/pavithra7369/pes_linearfsr/assets/143084423/c5f4f075-d8ba-4ba4-82c1-3c06d1572f7c)

> Statistics

Internal Power = 7.24e-05 W

Switching Power =  1.77e-05 W

Leakage Power =   1.30e-09  W

Total Power =  9.00e-05 W

